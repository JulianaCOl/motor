<!DOCTYPE html>
<html lang="pt-br">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Tow Mater Battle â€” Estourar BalÃ£o</title>
  <link rel="stylesheet" href="style.css" />
</head>
<body>
  <div class="painel">
    <h1>âš™ï¸ Tow Mater Battle Mode âš™ï¸</h1>
   

    <div class="tela">
      <div class="bola-wrap">
        <div id="baloon" class="baloon">
          <span class="shine"></span>
        </div>
      </div>
      <p class="status">Status: <span id="acao">Aguardando comando...</span></p>
    </div>

    <div class="controle">
      <button class="botao frente" onclick="enviarComando('/frente','AvanÃ§ando')">â¬†</button>

      <div class="linha-meio">
        <button class="botao esquerda" onclick="enviarComando('/esquerda','Virando esquerda')">â¬…</button>
        <button class="botao parar" onclick="enviarComando('/parar','Parado')">â¹</button>
        <button class="botao direita" onclick="enviarComando('/direita','Virando direita')">â¡</button>
      </div>

      <button class="botao re" onclick="enviarComando('/re','RÃ©')">â¬‡</button>
    </div>

    <div class="danger-zone">
      <button id="estourarBtn" class="estourar" onclick="confirmEstourar()">ğŸ’¥ ESTOURAR BALÃƒO</button>
    </div>

    <footer>ğŸ› ï¸ Tow Mater â€¢ ESP32 Wi-Fi Control ğŸ› ï¸</footer>
  </div>

<script>
  
  function enviarComando(url, texto) {
    document.getElementById('acao').textContent = texto;
    fetch(url).catch((e)=>console.warn('fetch erro', e));
    flashIndicator();
  }

  function flashIndicator() {
    const tela = document.querySelector('.tela');
    tela.classList.add('flash');
    setTimeout(()=>tela.classList.remove('flash'), 400);
  }

  function confirmEstourar() {
    if (!confirm('Tem certeza? Isso farÃ¡ o balÃ£o estourar!')) return;
    estourar();
  }

  
  function estourar() {
    document.getElementById('acao').textContent = 'Estourando balÃ£o...';
    
    const baloon = document.getElementById('baloon');
    baloon.classList.add('pop');
    
    fetch('/estourar', { method: 'POST' })
      .then(resp => {
        
      })
      .catch(err => console.warn('Erro estourar:', err));
    
    setTimeout(() => {
      baloon.classList.remove('pop');
      
      setTimeout(()=>document.getElementById('acao').textContent = 'Aguardando comando...', 1500);
    }, 700);
  }
</script>
</body>
</html>
